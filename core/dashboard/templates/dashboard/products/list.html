<!-- core\dashboard\templates\dashboard\products\list.html -->
{% extends 'dashboard/base/list_base.html' %}
{% load i18n %}
{% load dashboard_filters %}
{% load custom_filters %}
{% block title %}{% trans "Ürün Yönetimi" %}{% endblock %}
{% block page_title %}{% trans "Ürün Yönetimi" %}{% endblock %}

{% block page_content %}
<!-- Page Header -->
{% include 'dashboard/includes/navigation/page_header.html' with page_icon="fas fa-box-open" page_title=_("Ürün Yönetimi") page_subtitle=_("Ürünlerinizi kolayca yönetin ve takip edin") page_actions=page_actions %}


<!-- Stats Grid -->
<div class="stats-grid mb-4">
    {% include 'dashboard/includes/cards/stats_card.html' with card_icon="fas fa-boxes" card_value=products|length card_label=_("Toplam Ürün") card_color="primary" %}
    {% include 'dashboard/includes/cards/stats_card.html' with card_icon="fas fa-check-circle" card_value=active_products_count card_label=_("Aktif Ürünler") card_color="success" %}
    {% include 'dashboard/includes/cards/stats_card.html' with card_icon="fas fa-exclamation-triangle" card_value=low_stock_count card_label=_("Düşük Stok") card_color="warning" %}
    {% include 'dashboard/includes/cards/stats_card.html' with card_icon="fas fa-chart-line" card_value=total_value card_label=_("Toplam Değer") card_color="info" %}
</div>



<!-- Products Table -->
<div class="table-card">
    <div class="card-header-modern">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h5 class="mb-0">
                <i class="fas fa-boxes me-2"></i>{% trans "Ürün Listesi" %}
            </h5>
            <div class="d-flex gap-2">
                <button type="button" class="btn btn-outline-primary btn-sm" data-bs-toggle="collapse" data-bs-target="#productFilters">
                    <i class="fas fa-filter me-1"></i>{% trans "Filtreler" %}
                </button>
                <button type="button" class="btn-modern primary btn-sm" data-bs-toggle="modal" data-bs-target="#addProductModal">
                    <i class="fas fa-plus me-1"></i>{% trans "Yeni Ürün Ekle" %}
                </button>
            </div>
        </div>

        <!-- Filtreleme Bölümü -->
        <div class="collapse" id="productFilters">
            <div class="border-top pt-3 mb-3">
                <form method="get" id="filterForm">
                    <div class="row g-2 align-items-end">
                        <!-- Arama -->
                        <div class="col-md-4">
                            <div class="input-group">
                                <span class="input-group-text bg-light border-end-0">
                                    <i class="fas fa-search text-muted"></i>
                                </span>
                                <input type="text" name="search" class="form-control border-start-0" 
                                    placeholder="{% trans 'Ürün adı, kodu veya marka ara...' %}"
                                    value="{{ request.GET.search }}">
                            </div>
                        </div>
                        
                        <!-- Kategori -->
                        <div class="col-md-2">
                            <select name="category" class="form-select">
                                <option value="">{% trans "Tüm Kategoriler" %}</option>
                                {% for option in category_options %}
                                    <option value="{{ option.value }}" 
                                            {% if option.value|stringformat:"s" == request.GET.category %}selected{% endif %}>
                                        {{ option.label }}
                                    </option>
                                {% endfor %}
                            </select>
                        </div>
                        
                        <!-- Marka -->
                        <div class="col-md-2">
                            <select name="brand" class="form-select">
                                <option value="">{% trans "Tüm Markalar" %}</option>
                                {% for option in brand_options %}
                                    <option value="{{ option.value }}" 
                                            {% if option.value == request.GET.brand %}selected{% endif %}>
                                        {{ option.label }}
                                    </option>
                                {% endfor %}
                            </select>
                        </div>
                        
                        <!-- Durum -->
                        <div class="col-md-2">
                            <select name="status" class="form-select">
                                <option value="">{% trans "Tüm Durumlar" %}</option>
                                <option value="active" {% if request.GET.status == 'active' %}selected{% endif %}>{% trans "Aktif" %}</option>
                                <option value="inactive" {% if request.GET.status == 'inactive' %}selected{% endif %}>{% trans "Pasif" %}</option>
                            </select>
                        </div>
                        
                        <!-- Butonlar -->
                        <div class="col-md-2">
                            <div class="d-flex gap-1">
                                <button type="submit" class="btn btn-primary btn-sm flex-fill">
                                    <i class="fas fa-search"></i>
                                </button>
                                <button type="button" class="btn btn-outline-secondary btn-sm" onclick="resetFilters()">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div class="card-body p-0">
        <div class="table-responsive">
            <table class="table table-modern table-hover" id="productsTable">
                {% include 'dashboard/includes/tables/table_header.html' with table_type='products' %}
                
                <tbody>
                    {% if products %}

                        {% for product_data in products_with_translations %}
                        {% with product=product_data.object %}

                            <tr>
                                <td>
                                    {% if product.image %}
                                        <img src="{{ product.image.url }}" class="rounded" style="width: 60px; height: 60px; object-fit: cover;" alt="{{ product.name }}">
                                    {% else %}
                                        <div class="bg-light rounded d-flex align-items-center justify-content-center" style="width: 60px; height: 60px;">
                                            <i class="fas fa-image text-muted"></i>
                                        </div>
                                    {% endif %}
                                </td>
                                <td>
                                    <div>
                                        <strong>{{ product.name }}</strong>
                                        {% if product.is_featured %}
                                            <span class="badge bg-warning ms-1">
                                                <i class="fas fa-star"></i> {% trans "Öne Çıkan" %}
                                            </span>
                                        {% endif %}
                                    </div>
                                </td>
                                <td>
                                    {% if product.sku %}
                                        <code class="bg-light px-2 py-1 rounded">{{ product.sku }}</code>
                                    {% else %}
                                        <span class="text-muted">—</span>
                                    {% endif %}
                                </td>
                                <td>{{ product.category.name }}</td>
                                <td>{{ product.brand|default:"—" }}</td>
                                <td>
                                    {% if product.has_discount %}
                                        <div>
                                            <span class="text-decoration-line-through text-muted small">{{ product.price }} ₺</span><br>
                                            <strong class="text-success">{{ product.discount_price }} ₺</strong>
                                            <span class="badge bg-success ms-1">-%{{ product.get_discount_percentage }}</span>
                                        </div>
                                    {% elif product.price %}
                                        <strong>{{ product.price }} ₺</strong>
                                    {% else %}
                                        <span class="text-muted">—</span>
                                    {% endif %}
                                </td>
                                <td>
                                    {% if product.stock is not None %}
                                        {% if product.stock > 10 %}
                                            <span class="text-success">{% blocktrans with stock=product.stock %}{{ stock }} adet{% endblocktrans %}</span>
                                        {% elif product.stock > 0 %}
                                            <span class="text-warning">{% blocktrans with stock=product.stock %}{{ stock }} adet{% endblocktrans %}</span>
                                        {% else %}
                                            <span class="text-danger">{% trans "Stokta Yok" %}</span>
                                        {% endif %}
                                    {% else %}
                                        <span class="text-muted">—</span>
                                    {% endif %}
                                </td>
                                <td>
                                    {% include 'dashboard/includes/ui/status_badge.html' with badge_text=product.is_active|yesno:"Aktif,Pasif" badge_color=product.is_active|yesno:"success,danger" %}
                                </td>
                                <td>{{ product.created_at|date:"d.m.Y" }}</td>
                                <td>
                                    <div class="action-buttons">
                                        <button type="button" class="btn btn-sm btn-outline-info" data-bs-toggle="modal" data-bs-target="#viewProductModal{{ product.id }}" title="{% trans 'Görüntüle' %}">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                        <button type="button" class="btn btn-sm btn-outline-warning" data-bs-toggle="modal" data-bs-target="#editProductModal{{ product.id }}" title="{% trans 'Düzenle' %}">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button type="button" class="btn btn-sm btn-outline-danger" data-bs-toggle="modal" data-bs-target="#deleteProductModal{{ product.id }}" title="{% trans 'Sil' %}">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>



                        {% endwith %}
                        {% endfor %}
                    {% else %}
                        <tr>
                            <td colspan="10">
                                {% include 'dashboard/includes/ui/empty_state.html' with empty_icon="fas fa-boxes" empty_title=_("Henüz ürün eklenmemiş") empty_message=_("İlk ürününüzü ekleyerek başlayın") action_button_text=_("İlk Ürünü Ekle") action_button_icon="fas fa-plus" action_button_attrs='data-bs-toggle="modal" data-bs-target="#addProductModal"' %}
                            </td>
                        </tr>
                    {% endif %}

                </tbody>

            </table>
        </div>
    </div>
</div>

<!-- Add Product Modal -->
<div class="modal fade modal-modern" id="addProductModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="fas fa-plus me-2"></i>{% trans "Yeni Ürün Ekle" %}
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            
            <form method="post" enctype="multipart/form-data" id="addProductForm" action="{% url 'dashboard:product_add' %}">
                {% csrf_token %}
                
                <div class="modal-body">
                    <!-- Çeviri Dil Sekmeleri -->
                    {% if translation_enabled and enabled_languages|length > 1 %}
                        {% include 'dashboard/includes/forms/translation_tabs.html' %}
                    {% endif %}
                    
                    <!-- Türkçe İçerik (Ana Dil) -->
                    <div class="translation-content active" data-lang="tr">
                        <div class="row">
                            <div class="col-md-6">
                                {% include 'dashboard/includes/forms/form_field.html' with field_name="name" field_label=_("Ürün Adı") field_icon="fas fa-box" field_type="text" is_required=True help_text=_("Ürünün Türkçe adı") language_code="tr" %}
                            </div>
                            <div class="col-md-6">
                                {% include 'dashboard/includes/forms/select_field.html' with field_name="category" label=_("Kategori") icon="fas fa-tags" options=category_options required=True %}
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12">
                                {% include 'dashboard/includes/forms/url_field.html' with field_name="slug" label=_("URL") icon="fas fa-link" field_type="slug" source_field="name" help_text=_("Otomatik oluşturulur veya özel girebilirsiniz") %}
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12">
                                {% include 'dashboard/includes/forms/text_editor_field.html' with field_name="description" label=_("Açıklama") rows="4" help_text=_("Ürünün Türkçe açıklaması") %}
                            </div>
                        </div>
                    </div>

                    <!-- Çeviri Dilleri İçerikleri -->
                    {% if translation_enabled and enabled_languages|length > 1 %}
                        {% for lang in enabled_languages %}
                            {% if lang != 'tr' %}
                            <div class="translation-content" data-lang="{{ lang }}">
                                <div class="row">
                                    <div class="col-12">
                                        {% include 'dashboard/includes/forms/form_field.html' with field_name="name_"|add:lang field_label="Ürün Adı" field_icon="fas fa-box" field_type="text" is_required=True help_text="Bu alan zorunludur" language_code=lang %}
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-12">
                                        {% include 'dashboard/includes/forms/text_editor_field.html' with field_name="description_"|add:lang label="Açıklama" rows="4" help_text="Bu alan zorunludur" %}
                                    </div>
                                </div>
                            </div>
                            {% endif %}
                        {% endfor %}
                    {% endif %}

                    <!-- Diğer Alanlar (Ortak) -->
                    <div class="card-modern mt-4">
                        <div class="card-header-modern">
                            <h6 class="mb-0">
                                <i class="fas fa-cogs me-2"></i>{% trans "Ürün Detayları" %}
                            </h6>
                        </div>
                        <div class="card-body-modern">
                            <div class="row">
                                <div class="col-md-6">
                                    {% include 'dashboard/includes/forms/form_field.html' with field_name="price" field_label=_("Fiyat") field_icon="fas fa-lira-sign" field_type="number" field_step="0.01" help_text=_("İsteğe bağlı") %}
                                </div>
                                <div class="col-md-6">
                                    {% include 'dashboard/includes/forms/form_field.html' with field_name="stock" field_label=_("Stok") field_icon="fas fa-warehouse" field_type="number" help_text=_("İsteğe bağlı") %}
                                </div>
                            </div>


                            <div class="row">
                                <div class="col-md-6">
                                    {% include 'dashboard/includes/forms/form_field.html' with field_name="discount_price" field_label=_("İndirimli Fiyat") field_icon="fas fa-percent" field_type="number" field_step="0.01" help_text=_("İndirim varsa bu alanı doldurun") %}
                                </div>
                                <div class="col-md-6">
                                    {% include 'dashboard/includes/forms/form_field.html' with field_name="sku" field_label=_("Ürün Kodu") field_icon="fas fa-barcode" field_type="text" help_text=_("Otomatik oluşturulur") %}
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    {% include 'dashboard/includes/forms/form_field.html' with field_name="brand" field_label=_("Marka") field_icon="fas fa-tag" field_type="text" help_text=_("İsteğe bağlı") %}
                                </div>
                                <div class="col-md-6">
                                    {% include 'dashboard/includes/forms/form_field.html' with field_name="weight" field_label=_("Ağırlık (kg)") field_icon="fas fa-weight-hanging" field_type="number" field_step="0.01" help_text=_("İsteğe bağlı") %}
                                </div>
                            </div>


                            
                            <div class="row">
                                <div class="col-12">
                                    {% include 'dashboard/includes/forms/image_upload_field.html' with field_name="image" label=_("Ürün Görseli") help_text=_("JPG, PNG formatlarında görsel yükleyebilirsiniz") %}
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-12">
                                    {% include 'dashboard/includes/forms/form_field.html' with field_name="alt_text" field_label=_("Alt Metin (SEO)") field_icon="fas fa-paragraph" field_type="text" help_text=_("Ürün görseli için SEO alt metni (max 125 karakter)") %}
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    {% include 'dashboard/includes/forms/form_field.html' with field_name="meta_title" field_label=_("Meta Başlık") field_icon="fas fa-heading" field_type="text" help_text=_("SEO için") %}
                                </div>
                                <div class="col-md-6">
                                    {% include 'dashboard/includes/forms/form_field.html' with field_name="meta_description" field_label=_("Meta Açıklama") field_icon="fas fa-paragraph" field_type="textarea" field_rows="2" help_text=_("SEO için") %}
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    {% include 'dashboard/includes/forms/checkbox_field.html' with field_name="is_featured" label=_("Öne Çıkan Ürün") field_type="switch" icon="fas fa-star" %}
                                </div>
                                <div class="col-md-6">
                                    {% include 'dashboard/includes/forms/checkbox_field.html' with field_name="is_active" label=_("Satışta") field_type="switch" icon="fas fa-toggle-on" checked=True %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>{% trans "İptal" %}
                    </button>
                    <button type="submit" class="btn-modern primary">
                        <i class="fas fa-save me-2"></i>{% trans "Ürünü Kaydet" %}
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Edit Product Modals -->
{% for product_data in products_with_translations %}
{% with product=product_data.object %}
<div class="modal fade modal-modern" id="editProductModal{{ product.id }}">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="fas fa-edit me-2"></i>{% trans "Ürün Düzenle" %}: {{ product.name }}
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <form method="post" enctype="multipart/form-data" id="editProductForm{{ product.id }}" action="{% url 'dashboard:product_edit' product.id %}" novalidate>
                {% csrf_token %}
                <input type="hidden" name="product_id" value="{{ product.id }}">
                
                <div class="modal-body">
                    <!-- Çeviri Dil Sekmeleri -->
                    {% if translation_enabled and enabled_languages|length > 1 %}
                        {% include 'dashboard/includes/forms/translation_tabs.html' %}
                    {% endif %}

                    <!-- Türkçe İçerik -->
                    <div class="translation-content active" data-lang="tr">
                        <div class="row">
                            <div class="col-md-6">
                                {% include 'dashboard/includes/forms/form_field.html' with field_name="name" field_label="Ürün Adı" field_icon="fas fa-box" field_type="text" field_value=product.name is_required=True language_code="tr" %}
                            </div>
                            <div class="col-md-6">
                                {% include 'dashboard/includes/forms/select_field.html' with field_name="category" label="Kategori" icon="fas fa-tags" options=category_options selected_value=product.category.id required=True %}
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12">
                                {% include 'dashboard/includes/forms/url_field.html' with field_name="slug" label="URL" icon="fas fa-link" value=product.slug required=False %}
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12">
                                {% include 'dashboard/includes/forms/text_editor_field.html' with field_name="description" label="Açıklama" value=product.description|striptags rows="3" %}
                            </div>
                        </div>
                    </div>

                    <!-- Çeviri Dilleri İçerikleri -->
                    {% if translation_enabled and enabled_languages|length > 1 %}
                        {% for lang in enabled_languages %}
                            {% if lang != 'tr' %}
                            <div class="translation-content" data-lang="{{ lang }}">
                                <div class="row">
                                    <div class="col-12">
                                        {% include 'dashboard/includes/forms/form_field.html' with field_name="name_"|add:lang field_label="Ürün Adı" field_icon="fas fa-box" field_type="text" field_value=product_data.translations|lookup:lang|lookup:"name" is_required=True help_text="Bu alan zorunludur" language_code=lang %}
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-12">
                                        {% include 'dashboard/includes/forms/text_editor_field.html' with field_name="description_"|add:lang label="Açıklama" value=product_data.translations|lookup:lang|lookup:"description" rows="3" help_text="Bu alan zorunludur" %}
                                    </div>
                                </div>
                            </div>
                            {% endif %}
                        {% endfor %}
                    {% endif %}

                    <!-- Diğer Alanlar (Ortak) -->
                    <div class="card-modern mt-4">
                        <div class="card-header-modern">
                            <h6 class="mb-0">
                                <i class="fas fa-cogs me-2"></i>{% trans "Ürün Detayları" %}
                            </h6>
                        </div>
                        <div class="card-body-modern">
                            <div class="row">
                                <div class="col-md-6">
                                    {% include 'dashboard/includes/forms/form_field.html' with field_name="price" field_label="Fiyat" field_icon="fas fa-lira-sign" field_type="number" field_step="0.01" field_value=product.price help_text="İsteğe bağlı" %}
                                </div>
                                <div class="col-md-6">
                                    {% include 'dashboard/includes/forms/form_field.html' with field_name="stock" field_label="Stok" field_icon="fas fa-warehouse" field_type="number" field_value=product.stock help_text="İsteğe bağlı" %}
                                </div>
                            </div>



                            <div class="row">
                                <div class="col-md-6">
                                    {% include 'dashboard/includes/forms/form_field.html' with field_name="discount_price" field_label="İndirimli Fiyat" field_icon="fas fa-percent" field_type="number" field_step="0.01" field_value=product.discount_price help_text="İndirim varsa bu alanı doldurun" %}
                                </div>
                                <div class="col-md-6">
                                    {% include 'dashboard/includes/forms/form_field.html' with field_name="sku" field_label=_("Ürün Kodu") field_icon="fas fa-barcode" field_type="text" field_value=product.sku help_text=_("Değiştirebilirsiniz") %}
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-6">
                                    {% include 'dashboard/includes/forms/form_field.html' with field_name="brand" field_label="Marka" field_icon="fas fa-tag" field_type="text" field_value=product.brand help_text="İsteğe bağlı" %}
                                </div>
                                <div class="col-md-6">
                                    {% include 'dashboard/includes/forms/form_field.html' with field_name="weight" field_label="Ağırlık (kg)" field_icon="fas fa-weight-hanging" field_type="number" field_step="0.01" field_value=product.weight help_text="İsteğe bağlı" %}
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-12">
                                    {% include 'dashboard/includes/forms/image_upload_field.html' with field_name="image" label=_("Ürün Görseli") current_image=product.image help_text=_("Yeni bir görsel seçmezseniz mevcut görsel korunur") %}
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-12">
                                    {% include 'dashboard/includes/forms/form_field.html' with field_name="alt_text" field_label="Alt Metin (SEO)" field_icon="fas fa-paragraph" field_type="text" field_value=product.alt_text help_text="Ürün görseli için SEO alt metni (max 125 karakter)" %}
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    {% include 'dashboard/includes/forms/form_field.html' with field_name="meta_title" field_label="Meta Başlık" field_icon="fas fa-heading" field_type="text" field_value=product.meta_title help_text="SEO için" %}
                                </div>
                                <div class="col-md-6">
                                    {% include 'dashboard/includes/forms/form_field.html' with field_name="meta_description" field_label="Meta Açıklama" field_icon="fas fa-paragraph" field_type="textarea" field_rows="2" field_value=product.meta_description help_text="SEO için" %}
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    {% include 'dashboard/includes/forms/checkbox_field.html' with field_name="is_featured" label="Öne Çıkan Ürün" field_type="switch" icon="fas fa-star" checked=product.is_featured %}
                                </div>
                                <div class="col-md-6">
                                    {% include 'dashboard/includes/forms/checkbox_field.html' with field_name="is_active" label="Satışta" field_type="switch" icon="fas fa-toggle-on" checked=product.is_active %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>{% trans "İptal" %}
                    </button>
                    <button type="submit" class="btn-modern primary">
                        <i class="fas fa-save"></i>{% trans "Değişiklikleri Kaydet" %}
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- View Product Modal -->
<div class="modal fade modal-modern" id="viewProductModal{{ product.id }}" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="fas fa-eye me-2"></i>{% trans "Ürün Detayları" %}: {{ product.name }}
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-4">
                        {% if product.image %}
                            <img src="{{ product.image.url }}" alt="{{ product.get_alt_text }}" class="img-fluid rounded" loading="lazy">
                        {% else %}
                            <div class="text-center p-4 bg-light rounded">
                                <i class="fas fa-image fa-3x text-muted"></i>
                                <p class="text-muted mt-2">{% trans "Görsel yok" %}</p>
                            </div>
                        {% endif %}
                    </div>
                    <div class="col-md-8">
                        <div class="product-details">
                            <h4>{{ product.name }}</h4>
                            <p class="text-muted">{{ product.description|striptags }}</p>
                            
                            <div class="product-meta">
                                <div class="mb-2">
                                    <strong>{% trans "Kategori" %}:</strong> {{ product.category.name }}
                                </div>
                                <div class="mb-2">
                                    <strong>{% trans "Fiyat" %}:</strong> 
                                    {% if product.price %}
                                        {{ product.price|floatformat:2 }} ₺
                                    {% else %}
                                        <span class="text-muted">{% trans "Belirtilmemiş" %}</span>
                                    {% endif %}
                                </div>
                                <div class="mb-2">
                                    <strong>{% trans "Stok" %}:</strong> 
                                    {% if product.stock is not None %}
                                        {% blocktrans with stock=product.stock %}{{ stock }} adet{% endblocktrans %}
                                    {% else %}
                                        <span class="text-muted">{% trans "Belirtilmemiş" %}</span>
                                    {% endif %}
                                </div>

                                {% if product.discount_price %}
                                <div class="mb-2">
                                    <strong>{% trans "İndirimli Fiyat" %}:</strong> {{ product.discount_price|floatformat:2 }} ₺
                                    {% if product.has_discount %}
                                        <span class="badge bg-success ms-2">
                                            {% blocktrans with percentage=product.get_discount_percentage %}%{{ percentage }} indirim{% endblocktrans %}
                                        </span>
                                    {% endif %}
                                </div>
                                {% endif %}

                                {% if product.sku %}
                                <div class="mb-2">
                                    <strong>{% trans "Ürün Kodu" %}:</strong> 
                                    <code>{{ product.sku }}</code>
                                </div>
                                {% endif %}

                                {% if product.brand %}
                                <div class="mb-2">
                                    <strong>{% trans "Marka" %}:</strong> {{ product.brand }}
                                </div>
                                {% endif %}

                                {% if product.weight %}
                                <div class="mb-2">
                                    <strong>{% trans "Ağırlık" %}:</strong> {{ product.weight }} kg
                                </div>
                                {% endif %}

                                <div class="mb-2">
                                    <strong>{% trans "Durum" %}:</strong>
                                    {% include 'dashboard/includes/ui/status_badge.html' with badge_text=product.is_active|yesno:_("Satışta")|add:","|add:_("Pasif") badge_color=product.is_active|yesno:"success,danger" %}
                                </div>
                                {% if product.is_featured %}
                                <div class="mb-2">
                                    {% include 'dashboard/includes/ui/status_badge.html' with badge_text=_("Öne Çıkan") badge_color="warning" badge_icon="fas fa-star" %}
                                </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">
                    <i class="fas fa-times me-2"></i>{% trans "Kapat" %}
                </button>
                <button type="button" class="btn-modern primary" data-bs-toggle="modal" data-bs-target="#editProductModal{{ product.id }}">
                    <i class="fas fa-edit me-2"></i>{% trans "Düzenle" %}
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Delete Product Modal -->
<!-- Delete Product Modal -->
<!-- Delete Product Modal -->
<div class="modal fade" id="deleteProductModal{{ product.id }}" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-danger text-white">
                <h5 class="modal-title">
                    <i class="fas fa-exclamation-triangle me-2"></i>{% trans "Ürün Sil" %}
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="text-center">
                    <i class="fas fa-trash-alt text-danger fa-3x mb-3"></i>
                    <h5>{% trans "Bu ürünü silmek istediğinizden emin misiniz?" %}</h5>
                    <p class="text-muted">
                        <strong>"{{ product.name }}"</strong> {% trans "kalıcı olarak silinecek." %}
                    </p>
                    <div class="alert alert-warning mt-3">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        {% trans "Bu işlem geri alınamaz!" %}
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    <i class="fas fa-times me-2"></i>{% trans "İptal" %}
                </button>
                
                <form method="post" style="display: inline;" class="delete-form" 
                    data-item-type="{% trans 'ürün' %}"
                    data-item-name="{{ product.name }}"
                    action="{% url 'dashboard:product_delete' product.id %}">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-danger delete-confirm-btn">
                        <i class="fas fa-trash me-2"></i>{% trans "Sil" %}
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endwith %}
{% endfor %}
{% include 'dashboard/includes/tables/table_pagination.html' %}

{% endblock %}

{% block list_modals %}
<!-- Bulk Actions Modal -->
{% include 'dashboard/includes/modals/bulk_actions_modal.html' %}
{% endblock %}
<!-- Page specific JS -->
<!-- Page specific JS -->
{% block extra_js %}
{% load static %}
<script src="{% static 'dashboard/js/components/image-crop.js' %}"></script>
<script src="{% static 'dashboard/js/pages/products.js' %}"></script>
<script>
function resetFilters() {
    // Tüm filtreleri temizle ve sadece sayfa URL'sine git
    window.location.href = window.location.pathname;
}
</script>
{% endblock %}