<!--core\templates\base\includes\back_to_top.html # Yukarı çık butonu-->
{% load static %}
{% load i18n %}

<button class="back-to-top" 
        id="backToTop" 
        type="button"
        title="{% trans 'Sayfanın başına dön' %}" 
        aria-label="{% trans 'Sayfanın başına dön' %}"
        style="display: none;">
    <i class="fas fa-arrow-up" aria-hidden="true"></i>
    <div class="btn-ripple"></div>
</button>

<style>
.back-to-top {
    position: fixed;
    bottom: 30px;
    right: 30px;
    z-index: 1000;
    width: 50px;
    height: 50px;
    border: none;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
    color: white;
    font-size: 1.125rem;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
    backdrop-filter: blur(10px);
    overflow: hidden;
    position: relative;
}

.back-to-top:hover {
    transform: translateY(-3px) scale(1.05);
    box-shadow: 0 8px 30px rgba(var(--primary-color), 0.4);
}

.back-to-top:active {
    transform: translateY(0) scale(0.95);
}

.back-to-top.show {
    display: flex !important;
    align-items: center;
    justify-content: center;
    animation: backToTopSlideIn 0.3s ease-out;
}

.back-to-top.hide {
    animation: backToTopSlideOut 0.3s ease-in forwards;
}

.btn-ripple {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.3);
    transform: translate(-50%, -50%);
    transition: width 0.6s, height 0.6s;
}

.back-to-top:active .btn-ripple {
    width: 60px;
    height: 60px;
}

@keyframes backToTopSlideIn {
    from {
        opacity: 0;
        transform: translateY(20px) scale(0.8);
    }
    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

@keyframes backToTopSlideOut {
    from {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
    to {
        opacity: 0;
        transform: translateY(20px) scale(0.8);
        display: none;
    }
}

@media (max-width: 767.98px) {
    .back-to-top {
        bottom: 20px;
        right: 20px;
        width: 45px;
        height: 45px;
        font-size: 1rem;
    }
}

@media (prefers-reduced-motion: reduce) {
    .back-to-top {
        transition: none;
        animation: none;
    }
    
    .back-to-top:hover {
        transform: none;
    }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const backToTopBtn = document.getElementById('backToTop');
    let isVisible = false;
    let ticking = false;
    
    function updateBackToTopVisibility() {
        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
        const shouldShow = scrollTop > 300;
        
        if (shouldShow !== isVisible) {
            isVisible = shouldShow;
            
            if (shouldShow) {
                backToTopBtn.style.display = 'flex';
                backToTopBtn.classList.add('show');
                backToTopBtn.classList.remove('hide');
            } else {
                backToTopBtn.classList.add('hide');
                backToTopBtn.classList.remove('show');
                setTimeout(() => {
                    if (!isVisible) {
                        backToTopBtn.style.display = 'none';
                    }
                }, 300);
            }
        }
    }
    
    function handleScroll() {
        if (!ticking) {
            requestAnimationFrame(() => {
                updateBackToTopVisibility();
                ticking = false;
            });
            ticking = true;
        }
    }
    
    function scrollToTop() {
        const startPosition = window.pageYOffset;
        const startTime = performance.now();
        const duration = 800;
        
        function easeInOutCubic(t) {
            return t < 0.5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1;
        }
        
        function animateScroll(currentTime) {
            const timeElapsed = currentTime - startTime;
            const progress = Math.min(timeElapsed / duration, 1);
            const ease = easeInOutCubic(progress);
            
            window.scrollTo(0, startPosition * (1 - ease));
            
            if (progress < 1) {
                requestAnimationFrame(animateScroll);
            }
        }
        
        requestAnimationFrame(animateScroll);
    }
    
    // Event listeners
    window.addEventListener('scroll', handleScroll, { passive: true });
    
    backToTopBtn.addEventListener('click', function(e) {
        e.preventDefault();
        scrollToTop();
        
        // Analytics tracking
        if (typeof gtag !== 'undefined') {
            gtag('event', 'scroll_to_top', {
                event_category: 'engagement',
                event_label: 'back_to_top_button'
            });
        }
    });
    
    // Keyboard support
    backToTopBtn.addEventListener('keydown', function(e) {
        if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            scrollToTop();
        }
    });
    
    // Initial check
    updateBackToTopVisibility();
});
</script>